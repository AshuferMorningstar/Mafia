<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🎲 Mafia Game</title>
    <link rel="stylesheet" href="styles.css?v=2024">
</head>
<body>
    <!-- Splash Screen -->
    <div id="splash-screen" class="splash-screen active">
        <div class="splash-content">
            <div class="splash-logo">
                <img src="mafialogo.png" alt="Mafia Game Logo" class="splash-logo-img">
            </div>
            <h1 class="splash-title">🎲 Mafia Game</h1>
            <p class="splash-subtitle">A thrilling game of deception and strategy</p>
            <div class="loading-spinner">
                <div class="spinner"></div>
            </div>
            <p class="loading-text">Loading...</p>
        </div>
    </div>

    <!-- Top Logo Section -->
    <div class="top-logo-section" id="top-logo-section" style="display: none;">
        <div class="logo-container">
            <img src="mafialogo.png" alt="Mafia Game Logo" class="top-logo">
        </div>
    </div>

    <!-- Welcome Screen (Outside Container) -->
    <div id="welcome-screen" class="game-screen active welcome-screen-container" style="display: none;">
        <div class="welcome-content">
            <h1>Mafia Game</h1>
            <p>A thrilling game of deception and strategy</p>
            <div class="welcome-buttons">
                <button class="btn welcome-btn" onclick="showCreateGame()">🎲 Create New Game</button>
                <button class="btn btn-secondary welcome-btn" onclick="showJoinGame()">🚪 Join Game</button>
            </div>
        </div>
    </div>

    <div class="container" id="main-container" style="display: none;">
        <!-- Create Game Page -->
        <div id="create-game-screen" class="game-screen">
            <div class="page-header">
                <button class="btn-back" onclick="goToWelcome()">
                    <span class="back-arrow">←</span>
                    <span>Back</span>
                </button>
                <h1>🎲 Create New Game</h1>
                <p>Start a new Mafia game and invite friends</p>
            </div>
            
            <div class="page-content">
                <div class="form-group">
                    <label for="create-player-name">Your Name:</label>
                    <input type="text" id="create-player-name" placeholder="Enter your name" maxlength="20">
                </div>
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="createGame()">🚀 Create Game Room</button>
                </div>
            </div>
        </div>

        <!-- Join Game Page -->
        <div id="join-game-screen" class="game-screen">
            <div class="page-header">
                <button class="btn-back" onclick="goToWelcome()">
                    <span class="back-arrow">←</span>
                    <span>Back</span>
                </button>
                <h1>🚪 Join Game</h1>
                <p>Enter the room code to join an existing game</p>
            </div>
            
            <div class="page-content">
                <div class="form-group">
                    <label for="join-player-name">Your Name:</label>
                    <input type="text" id="join-player-name" placeholder="Enter your name" maxlength="20">
                </div>
                <div class="form-group">
                    <label for="room-code">Room Code:</label>
                    <input type="text" id="room-code" placeholder="Enter 6-character room code" maxlength="6" style="text-transform: uppercase;">
                </div>
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="joinGame()">🎯 Join Game Room</button>
                </div>
            </div>
        </div>

        <!-- Original Game Content Screens -->
        <div class="header" id="original-header">
            <h1>Mafia Game</h1>
            <p>A thrilling game of deception and strategy</p>
        </div>

        <!-- Lobby Screen -->
        <div id="lobby-screen" class="game-screen">
            <div class="room-info">
                <div class="lobby-header">
                    <img src="mafialogo.png" alt="Mafia Game Logo" class="lobby-logo">
                    <h2>🏠 Game Lobby</h2>
                </div>
                <p><strong>Room Code:</strong></p>
                <div class="room-code" id="lobby-room-code"></div>
                <p>Share this code with friends to join!</p>
            </div>

            <div class="players-list">
                <h3>👥 Players (<span id="player-count">0</span>)</h3>
                <div id="players-container"></div>
            </div>

            <!-- Speaker Settings (Host Only) -->
            <div class="speaker-settings" id="speaker-settings">
                <h3>🎙️ Speaker Settings</h3>
                <div class="setting-item">
                    <label class="toggle-switch">
                        <input type="checkbox" id="random-speaker-toggle" onchange="toggleRandomSpeaker()">
                        <span class="slider"></span>
                        <span class="setting-label">Random Speaker Assignment</span>
                    </label>
                    <p class="setting-description">When enabled, a speaker will be chosen randomly at game start</p>
                </div>
                <div class="speaker-controls" id="manual-speaker-controls">
                    <button class="btn btn-secondary" onclick="assignRandomSpeakerNow()">🎲 Assign Random Speaker Now</button>
                </div>
            </div>

            <!-- Chat in Lobby -->
            <div class="chat-container" id="lobby-chat-container">
                <div class="chat-header">
                    <h3>💬 Lobby Chat</h3>
                    <span id="lobby-chat-status">Online</span>
                </div>
                <div class="chat-messages" id="lobby-chat-messages"></div>
                <div class="chat-input-container modern-chat">
                    <input type="text" id="lobby-chat-input" placeholder="Type a message..." maxlength="500">
                    <button class="btn btn-secondary chat-send-btn" onclick="sendChatMessage()">➤</button>
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn" id="start-game-btn" onclick="startGame()" disabled>🎮 Start Game</button>
                <div id="speaker-requirement" class="speaker-notice hidden">
                    <p>⚠️ A speaker must be assigned before starting the game</p>
                </div>
                <button class="btn btn-danger" onclick="leaveGame()">🚪 Leave Game</button>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="game-screen" class="game-screen">
            <div class="game-info">
                <div class="game-header">
                    <img src="mafialogo.png" alt="Mafia Game Logo" class="game-screen-logo">
                    <div class="phase-indicator" id="phase-indicator">
                        🌙 Night Phase
                    </div>
                </div>
                <p><strong>Your Role:</strong> <span id="your-role" class="role-badge">Unknown</span></p>
                <div id="role-description"></div>
            </div>

            <div class="grid">
                <div class="players-list">
                    <h3>👥 Alive Players (<span id="alive-count">0</span>)</h3>
                    <div id="alive-players-container"></div>
                </div>

                <div class="players-list">
                    <h3>💀 Eliminated Players</h3>
                    <div id="dead-players-container"></div>
                </div>
            </div>

            <!-- Role Summary -->
            <div class="role-summary" id="role-summary">
                <div class="role-summary-header" onclick="toggleRoleSummary()">
                    <h3>🎭 Role Information</h3>
                    <span class="toggle-icon" id="role-summary-toggle">▼</span>
                </div>
                <div class="role-info-grid" id="role-info-content">
                    <div class="role-info-item">
                        <span class="role-badge role-civilian">👤 Civilian</span>
                        <p>Find and eliminate killers during voting</p>
                    </div>
                    <div class="role-info-item">
                        <span class="role-badge role-killer">🔪 Killer</span>
                        <p>Eliminate players at night, avoid detection</p>
                    </div>
                    <div class="role-info-item">
                        <span class="role-badge role-doctor">🩺 Doctor</span>
                        <p>Save one player from elimination each night</p>
                    </div>
                    <div class="role-info-item">
                        <span class="role-badge role-detective">🔍 Detective</span>
                        <p>Investigate players to learn if they're killers</p>
                    </div>
                </div>
            </div>

            <div id="night-actions" class="hidden">
                <h3>🌙 Night Actions</h3>
                <div id="night-targets"></div>
            </div>

            <div id="day-voting" class="hidden">
                <h3>🗳️ Day Voting</h3>
                <p>Choose who to eliminate:</p>
                <div id="voting-targets"></div>
            </div>

            <div id="speaker-controls" class="hidden">
                <h3>🎙️ Speaker Controls</h3>
                <div class="action-buttons">
                    <button class="btn" id="process-night-btn" onclick="processNight()" disabled>Process Night</button>
                    <button class="btn" id="start-voting-btn" onclick="startVoting()" disabled>Start Voting</button>
                    <button class="btn" id="process-votes-btn" onclick="processVotes()" disabled>Process Votes</button>
                </div>
            </div>

            <div class="messages" id="game-messages"></div>

            <!-- Chat System -->
            <div class="chat-container" id="chat-container">
                <div class="chat-header">
                    <h3>💬 Game Chat</h3>
                    <span id="chat-status">Online</span>
                </div>
                <div class="chat-messages" id="chat-messages"></div>
                <div class="chat-input-container modern-chat" id="chat-input-container">
                    <input type="text" id="chat-input" placeholder="Type a message..." maxlength="500">
                    <button class="btn btn-secondary chat-send-btn" onclick="sendChatMessage()">➤</button>
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-danger" onclick="leaveGame()">🚪 Leave Game</button>
            </div>
        </div>

        <!-- Game Over Screen -->
        <div id="game-over-screen" class="game-screen">
            <div class="game-info">
                <div class="game-over-header">
                    <img src="mafialogo.png" alt="Mafia Game Logo" class="game-over-logo">
                    <h2 id="game-over-title">🎉 Game Over!</h2>
                </div>
                <p id="game-over-message"></p>
            </div>

            <div class="players-list">
                <h3>👥 Final Players</h3>
                <div id="final-players-container"></div>
            </div>

            <div class="action-buttons">
                <button class="btn" onclick="goToWelcome()">🏠 Back to Menu</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="game.js"></script>
</body>
</html>
